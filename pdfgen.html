<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Checklist PDF Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
<script>
  // Wait until jsPDF is ready
  window.onload = () => {
    const { jsPDF } = window.jspdf;

    // Get URL parameters
    const params = new URLSearchParams(window.location.search);
    const candidateName = params.get("name") || "Unknown Candidate";
    const checklistParam = params.get("checklist") || "";

    // Split checklist into array (Zoho uses semicolon ; separator)
    const checklist = checklistParam.split(";");

    // Create new PDF
    const doc = new jsPDF();

    let y = 20; // initial Y position
    doc.setFontSize(14);
    doc.text("Candidate: " + candidateName, 10, y);
    y += 10;
    doc.text("Checklist_Test_1:", 10, y);
    y += 10;

    if (checklist.length > 0 && checklist[0] !== "") {
      checklist.forEach((item, i) => {
        doc.text((i + 1) + ". " + item.trim(), 10, y);
        y += 10;
      });
    } else {
      doc.text("No checklist items selected.", 10, y);
    }

    // Save PDF
    doc.save(candidateName.replace(/\s+/g, "_") + "_Checklist.pdf");

    // Close tab after 2 seconds
    setTimeout(() => window.close(), 2000);
  };
</script>
</body>
</html>
